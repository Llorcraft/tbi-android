<ion-content [ngClass]="{'creating-pdf': creating_pdf}">
  <div class="hide-pdf">
    <div>
      <ion-icon color="royal" name="refresh"></ion-icon>
    </div>
  </div>

  <kendo-pdf-export #pdf paperSize="A4" margin="0 5cm" [scale]="0.5" landscape="true" forcePageBreak=".page-break">
    <div class="first-page">
      <img class="licence-logo" src="{{images.TBI}}">
      <h1>TBI-Report</h1>
      <h1>Project:</h1>
      <img src="{{images.PRESENTATION}}">
      <img src="{{licences.getData().url_logo}}">
      <h3 style="visibility: hidden">Project:</h3>
      <div class="contact-container">
        <b>{{project.name}}</b>
        <u>Contact:</u>
        {{licences.getData().name}}<br>
        {{licences.getData().inspector_first_name}} {{licences.getData().inspector_last_name}}<br>
        <ng-container *ngIf="!!licences.getData().engineer_id">Certified TIPCHECK engineer: {{licences.getData().engineer_id}}</ng-container>
        <ng-container *ngIf="!licences.getData().engineer_id">&nbsp;</ng-container>
        <a style="display: block"  href="tel:{{licences.getData().phone_number}}">{{licences.getData().phone_number}}</a>
        <a style="display: block" href="{{licences.getData().mail}}">{{licences.getData().mail}}</a>
        <a style="display: block"  href="{{licences.getData().url}}">{{licences.getData().url}}</a>
      </div>
      <span>This Report was produced using the TBI-App<br>developed by EiiF: www.eiif.org</span>
    </div>

    <ion-grid style="padding: 7rem 3rem 4rem" *ngIf="hasEnergy" class="page-break">
      <output [attr.page-number]="1">
        This Report was produced using the TBI-App developed by EiiF: www.eiif.org
      </output>
      <ion-row>
        <ion-col col-6>
          <h4 text-left style="margin: 1rem 0 0">
            <strong>{{project.name}}</strong><br>
            <strong>Result at a glance</strong>
          </h4>
          <table class="result-glance">
            <tr>
              <td text-left colspan="5" style="padding-bottom: 2rem; white-space: nowrap">Annual current looses:</td>
            </tr>
            <tr>
              <td>&bull;</td>
              <td text-right>{{(totals.headLost.power) / 1000 | number: '1.2-2'}}</td>
              <td text-left>MWh</td>
              <td></td>
              <td></td>
            </tr>
            <tr>
              <td>&bull;</td>
              <td text-right>{{(totals.headLost.money) | number: '1.0-0'}}</td>
              <td text-left>{{project.currency}}</td>
              <td></td>
              <td></td>
            </tr>
            <tr>
              <td>&bull;</td>
              <td text-right>{{totals.co2[0] | number: '1.2-2'}}</td>
              <td text-left>tn CO<sub>2</sub></td>
              <td></td>
              <td></td>
            </tr>
          </table>
          <table class="result-glance">
            <tr>
              <td text-left colspan="5" style="padding-bottom: 2rem; white-space: nowrap">Annual saving potential:</td>
            </tr>
            <tr>
              <td>&bull;</td>
              <td text-right blue>{{(totals.savingPotentialMin?.power) / 1000 | number: '1.2-2'}}</td>
              <td text-center>-</td>
              <td text-left green>{{(totals.savingPotentialMax?.power) / 1000 | number: '1.2-2'}}</td>
              <td text-left>MWh</td>
            </tr>
            <tr>
              <td>&bull;</td>
              <td text-right blue>{{(totals.savingPotentialMin?.money) | number: '1.0-0'}}</td>
              <td text-center>-</td>
              <td text-left green>{{(totals.savingPotentialMax?.money) | number: '1.0-0'}}</td>
              <td text-left>{{project.currency}}</td>
            </tr>
            <tr>
              <td>&bull;</td>
              <td text-right blue>{{totals.co2[0] - totals.co2[1] | number: '1.2-2'}}</td>
              <td text-center>-</td>
              <td text-left green>{{totals.co2[0] - totals.co2[2] | number: '1.2-2'}}</td>
              <td text-left>tn CO<sub>2</sub></td>
            </tr>
          </table>
        </ion-col>
        <ion-col col-6 text-center>
          <div no-padding class="chart text-center chart-top"
            style="border-left: 1px solid rgb(48,84,150); margin: 0!important;">
            <div class="general-report-result" report-result (onReady)="export_pdf()" #report_result
              *ngIf="!!report && !!totals.headLost.power" [parent]="this" [currency]="project.currency"
              [show_advise]="true"></div>
          </div>
        </ion-col>
      </ion-row>
    </ion-grid>

    <ng-container *ngFor="let table of tables; let t = index">
      <output [attr.page-number]="table.index" class="table-page-counter page-break">
        This Report was produced using the TBI-App developed by EiiF: www.eiif.org
      </output>
      <div class="table-container">
      <table class="data" border="0">
        <colgroup>
          <col style="width: 50px">
          <col style="width: 100px">
          <col style="width: 70px">
          <col style="width: 70px">
          <col style="width: 70px">
          <col style="width: 10px">
          <col style="width: 70px">
          <col style="width: 10px">
          <col style="width: 100px">
          <col style="width: 100px">
          <col style="width: 100px">
          <col style="width: 80px">
          <col style="width: 50px">
          <col style="width: 50px">
          <col style="width: 10px">
          <col style="width: 30px">
          <col style="width: 30px">
          <col style="width: 30px">
          <col style="width: 30px">
          <col style="width: 30px">
        </colgroup>

        <thead>
          <tr>
            <th colspan="2"></th>
            <th colspan="5"
              style="border: 2px solid #fff; color:#fff; border-width: 0 0 4px 0; background-color: rgb(112,173,71)">
              Energy
              & CO2 analysis per year</th>
            <th rowspan="2"></th>
            <th rowspan="2"
              style="background-color: rgb(48,84,150); border: 2px solid #fff; color:#fff; border-width: 0 2px 4px 0">
              <!-- <span svg="safety"></span> -->
              <img width="100px" height="1px" style="display: block"
                src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDowNzE4MDI5NDU5NTMxMUU5QkI4MkZBN0U1NjUxQjNCNyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDowNzE4MDI5NTU5NTMxMUU5QkI4MkZBN0U1NjUxQjNCNyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjA3MTgwMjkyNTk1MzExRTlCQjgyRkE3RTU2NTFCM0I3IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjA3MTgwMjkzNTk1MzExRTlCQjgyRkE3RTU2NTFCM0I3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+hHvOAQAAABBJREFUeNpi+P//PwNAgAEACPwC/tuiTRYAAAAASUVORK5CYII=">
              Safety
            </th>
            <th rowspan="2"
              style="background-color: rgb(48,84,150); border: 2px solid #fff; color:#fff; border-width: 0 2px 4px 2px">
              <!-- <span svg="maintenance"></span> -->
              <img width="100px" height="1px" style="display: block"
                src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDowNzE4MDI5NDU5NTMxMUU5QkI4MkZBN0U1NjUxQjNCNyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDowNzE4MDI5NTU5NTMxMUU5QkI4MkZBN0U1NjUxQjNCNyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjA3MTgwMjkyNTk1MzExRTlCQjgyRkE3RTU2NTFCM0I3IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjA3MTgwMjkzNTk1MzExRTlCQjgyRkE3RTU2NTFCM0I3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+hHvOAQAAABBJREFUeNpi+P//PwNAgAEACPwC/tuiTRYAAAAASUVORK5CYII=">
              Maintenance</th>
            <th rowspan="2"
              style="background-color: rgb(48,84,150); border: 2px solid #fff; color:#fff; border-width: 0 2px 4px 2px">
              <!-- <span svg="custom"></span> -->
              <img width="100px" height="1px" style="display: block"
                src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDowNzE4MDI5NDU5NTMxMUU5QkI4MkZBN0U1NjUxQjNCNyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDowNzE4MDI5NTU5NTMxMUU5QkI4MkZBN0U1NjUxQjNCNyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjA3MTgwMjkyNTk1MzExRTlCQjgyRkE3RTU2NTFCM0I3IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjA3MTgwMjkzNTk1MzExRTlCQjgyRkE3RTU2NTFCM0I3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+hHvOAQAAABBJREFUeNpi+P//PwNAgAEACPwC/tuiTRYAAAAASUVORK5CYII=">
              Other</th>
            <th rowspan="2"
              style="background-color: rgb(48,84,150); border: 2px solid #fff; color:#fff; border-width: 0 2px 4px 2px">
              <img width="100px" height="1px" style="display: block"
                src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDowNzE4MDI5NDU5NTMxMUU5QkI4MkZBN0U1NjUxQjNCNyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDowNzE4MDI5NTU5NTMxMUU5QkI4MkZBN0U1NjUxQjNCNyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjA3MTgwMjkyNTk1MzExRTlCQjgyRkE3RTU2NTFCM0I3IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjA3MTgwMjkzNTk1MzExRTlCQjgyRkE3RTU2NTFCM0I3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+hHvOAQAAABBJREFUeNpi+P//PwNAgAEACPwC/tuiTRYAAAAASUVORK5CYII=">
              TBI Advice</th>
            <th rowspan="2" colspan="2" *ngIf="REPORT.VALIDATION"
              style="background-color: rgb(48,84,150); border: 2px solid #fff; color:#fff; border-width: 0 2px 4px 2px">
              <img width="100px" height="1px" style="display: block"
                src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDowNzE4MDI5NDU5NTMxMUU5QkI4MkZBN0U1NjUxQjNCNyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDowNzE4MDI5NTU5NTMxMUU5QkI4MkZBN0U1NjUxQjNCNyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjA3MTgwMjkyNTk1MzExRTlCQjgyRkE3RTU2NTFCM0I3IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjA3MTgwMjkzNTk1MzExRTlCQjgyRkE3RTU2NTFCM0I3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+hHvOAQAAABBJREFUeNpi+P//PwNAgAEACPwC/tuiTRYAAAAASUVORK5CYII=">
              Validation</th>
            <th rowspan="2" *ngIf="REPORT.VALIDATION"></th>
            <th colspan="5"
              style="background-color: rgb(48,84,150); border: 2px solid #fff; color:#fff; border-width: 0 0 4px 2px">
              Input</th>
          </tr>
          <tr>
            <th colspan="2">Component<br />Location</th>
            <th colspan="1" style="background-color:rgb(217,217,217); border: 2px solid #fff; border-width: 0 0 4px 0">
              Units</th>
            <th colspan="1"
              style="white-space: normal; background-color:rgb(217,217,217); border: 2px solid #fff; border-width: 0 4px 4px 4px">
              Current
              Losses & Emissions</th>
            <th colspan="3"
              style="white-space: normal; background-color:rgb(217,217,217); border: 2px solid #fff; border-width: 0 0 4px 0">
              Potential<br>savings</th>
            <th class="vertical">
              <div><span one-line>Insulated</span></div>
            </th>
            <th class="vertical">
              <div><span one-line>Surface (m<sup>2</sup>)</span></div>
            </th>
            <th class="vertical">
              <div><span one-line>Diameter</span></div>
            </th>
            <th class="vertical">
              <div><span one-line>Length</span></div>
            </th>
            <th class="vertical">
              <div><span one-line>Items number</span></div>
            </th>
          </tr>
        </thead>

        <tbody *ngFor="let c of table.components; let i = index">
          <tr [class.disabled]="c.fields.unknow_surface">
            <td rowspan="3" (click)="actions(c, $event)" double-border text-center
              style="white-space: nowrap; padding-right: 1rem">
              <ion-icon slot="icon-only" name="md-more" style="margin: 0 .25rem 0; float: left"></ion-icon>
              {{t * 8 + 1 + i}}
            </td>
            <td rowspan="3" on-tap="edit(c)" double-border>{{ellipsis(c.fields.location)}}</td>
            <td text-center nowrap [class.gray-text]="!!c.is_energy && c.fields.unknow_surface" *ngIf="!!c.is_energy">
              {{project.s_measure}}<span *ngIf="c.fields.unknow_surface">/m<sup>2</sup></span></td>
            <td style="border-left: 4px solid #fff; border-right: 4px solid #fff" nowrap
              [class.gray-text]="!!c.is_energy && c.fields.unknow_surface" *ngIf="!!c.is_energy" text-center>{{c.result.headLost.power
              / 1000 | number: '1.2-2'}}</td>
            <td nowrap [class.gray-text]="!!c.is_energy && c.fields.unknow_surface" *ngIf="!!c.is_energy" text-right>{{c.result.savingPotentialMin?.power
              / 1000 | number: '1.2-2'}}</td>
            <td nowrap [class.gray-text]="!!c.is_energy && c.fields.unknow_surface" *ngIf="!!c.is_energy" text-center
              class="p-0" style="padding: 0; white-space: nowrap">
              <!-- <ion-icon name="md-arrow-forward"></ion-icon> -->
              -
            </td>
            <td nowrap [class.gray-text]="!!c.is_energy && c.fields.unknow_surface" *ngIf="!!c.is_energy" text-left>{{c.result.savingPotentialMax?.power
              / 1000 | number: '1.2-2'}}</td>
            <td nowrap *ngIf="!c.is_energy" colspan="5" text-center double-border rowspan="3">Not considered ></td>
            <td nowrap rowspan="3"></td>
            <td nowrap rowspan="3" style="background: rgb(180,198,231)" double-border text-center>
              <ng-container *ngFor="let r of c.reports_by_type('safety|hot')">
                <a href="#" (click)="open(r, $event)" *ngIf="!r.component.is_hot || !r.energy">{{r.summary_id}}</a>
                <a href="#" (click)="open(r, $event)" *ngIf="!!r.component.is_hot && !!r.energy">Hot surface</a>
                <a href="#" (click)="open(r, $event)" *ngIf="!!r.component.is_cold && !!r.energy">Cold surface</a>
              </ng-container>
              <ion-icon name="md-add-circle" (click)="add_report('safety', c, $event)"></ion-icon>
            </td>
            <td *ngIf="c.is_energy" rowspan="3" style="background: rgb(217,225,242)" double-border text-center>
              <a href="#" (click)="open(r, $event)"
                *ngFor="let r of c.reports_by_type('maintenance|condensation|damaged')">{{r.summary_id}}</a>
              <ion-icon name="md-add-circle" (click)="add_report('maintenance',c , $event)"></ion-icon>
            </td>
            <td *ngIf="!c.is_energy" rowspan="3" style="background: rgb(217,225,242)" double-border text-center>
              <a href="#" (click)="open(r, $event)"
                *ngFor="let r of c.reports_by_type('maintenance|condensation|damaged')">{{r.summary_id}}</a>
              <ion-icon name="md-add-circle" (click)="add_report('maintenance',c , $event)"></ion-icon>
            </td>
            <td rowspan="3" style="background: rgb(231,235,247)" double-border text-center>
              <a href="#" (click)="open(r, $event)"
                *ngFor="let r of c.reports_by_type('generic|custom')">{{r.summary_id}}</a>
              <a href="#" (click)="open(r, $event)" *ngFor="let r of c.reports_by_type('cold')">Cold surface</a>
              <a href="#" (click)="edit(c, $event)" *ngIf="!!c.fields.space_warning"><strong
                  style="white-space: nowrap">No Space</strong></a>
              <ion-icon name="md-add-circle" (click)="add_custom_report(c, $event)"></ion-icon>
            </td>
            <td rowspan="3" double-border text-center>
              <ng-container [ngSwitch]="advises.get(c.result.advise)">
                <span advise-picture *ngSwitchCase="'Recommended'"><img src="{{images.INSULATION}}"></span>
                <span advise-picture *ngSwitchCase="'Maintenance'"><img src="{{images.MECHANICAL}}"></span>
                <span advise-picture *ngSwitchCase="'Unknow surface'"><img src="{{images.SURFACE}}"></span>
                <!-- <span advise-picture *ngSwitchCase="'OK'"><img src="{{images.LIKE}}"></span> -->
                <span advise-picture *ngSwitchCase="'SAVINGS-achieved'"><img src="{{images.INCREASE}}"></span>
              </ng-container>
            </td>
            <td nowrap double-border rowspan="3" *ngIf="!!REPORT.VALIDATION && !c.validationReport"
              style="background: #fff"></td>
            <td nowrap double-border rowspan="3" *ngIf="!!REPORT.VALIDATION && !c.validationReport"
              style="background: #fff"></td>
            <td nowrap *ngIf="!!REPORT.VALIDATION && !!c.validationReport" on-tap="edit_validation(c)" text-right>{{c.validationReport.reports[0].result.headLost.power
              / 1000 | number: '1.2-2'}}</td>
            <td nowrap *ngIf="!!REPORT.VALIDATION && !!c.validationReport" on-tap="edit_validation(c)" class="measure">
              {{project.s_measure}}
            </td>
            <td nowrap rowspan="3" colspan="5" *ngIf="!c.is_energy" double-border text-center></td>
            <ng-container *ngIf="!!c.is_energy">            
            <td nowrap rowspan="3" double-border text-center>{{!!c.insulated ? 'Y' : !!c.energy ? 'N': ''}}</td>
            <td nowrap *ngIf="null!=c.fields.surface_temp" rowspan="3" double-border text-center>{{c.fields.surface}}</td>
            <td nowrap *ngIf="null==c.fields.surface_temp" rowspan="3" double-border text-center>&nbsp;</td>
            <td nowrap rowspan="3" double-border text-center>
              <span>{{c.fields.main_dimension || c.fields.nominal_diameter}}</span>
            </td>
            <td rowspan="3" double-border text-center>{{c.fields.length}}</td>
            <td rowspan="3" double-border text-center>{{c.fields.number}}</td>
            </ng-container>
          </tr>

          <tr [class.gray-text]="!!c.is_energy && c.fields.unknow_surface" *ngIf="!!c.is_energy"
            [class.disabled]="c.fields.unknow_surface">
            <td text-center nowrap text-center class="mesure">{{project.currency}}<span
                *ngIf="c.fields.unknow_surface">/m<sup>2</sup></span>
            </td>
            <td nowrap text-center>{{c.result.headLost?.money | number: '1.0-0'}}</td>
            <td nowrap text-right>{{c.result.savingPotentialMin?.money | number: '1.0-0'}}</td>
            <td nowrap text-center class="p-0" style="padding: 0; white-space: nowrap;">-</td>
            <td nowrap text-left>{{c.result.savingPotentialMax?.money | number: '1.0-0'}}</td>
            <td nowrap *ngIf="!!c.validationReport" on-tap="edit_validation(c)" text-right>{{c.validationReport.reports[0].result.headLost?.money
              | number: '1.0-0'}}</td>
          </tr>

          <tr [class.gray-text]="!!c.is_energy && c.fields.unknow_surface" *ngIf="!!c.is_energy"
            [class.disabled]="c.fields.unknow_surface">
            <td text-center nowrap double-border class="mesure">tn CO<sub>2</sub><span
                *ngIf="c.fields.unknow_surface">/m<sup>2</sup></span></td>
            <td nowrap style="border-left: 4px solid #fff; border-right: 4px solid #fff" double-border text-center>
              {{c.result.co2[0] | number: '1.2-2'}}</td>
            <td nowrap double-border text-right>{{c.result.co2[0] - c.result.co2[1] | number: '1.2-2'}}</td>
            <td nowrap double-border text-center class="p-0" style="padding: 0; white-space: nowrap;">-</td>
            <td nowrap double-border text-left>{{c.result.co2[0] - c.result.co2[2] | number: '1.2-2'}}</td>
            <td nowrap *ngIf="!!c.validationReport" on-tap="edit_validation(c)" double-border text-right>{{c.validationReport.reports[0].result.co2[0]
              | number: '1.2-2'}}</td>
          </tr>
        </tbody>

        <tfoot *ngIf="!!components.length && table.last">
          <tr>
            <td rowspan="3" colspan="2" double-border text-right>
              ESTIMATION TOTAL PROJECT
            </td>
            <td text-center>{{project.s_measure}}</td>
            <td text-center>{{(totals.headLost.power / 1000) | number: '1.2-2'}}</td>
            <td text-right>{{totals.savingPotentialMin?.power / 1000 | number: '1.2-2'}}</td>
            <td text-center class="p-0" style="padding: 0; white-space: nowrap">-</td>
            <td text-left>{{totals.savingPotentialMax?.power / 1000 | number: '1.2-2'}}</td>
            <td colspan="2" double-border rowspan="3"></td>
            <td double-border [attr.colspan]="!!REPORT.VALIDATION ? 11 : 8" rowspan="3">
              <ion-grid>
                <ion-row class="legend">
                  <ion-col no-padding col-4><span advise-picture><img src="{{images.MECHANICAL}}"></span>Maintenance
                  </ion-col>
                  <ion-col no-padding col-6><span advise-picture><img src="{{images.INSULATION}}"></span>Insulation
                    recommended</ion-col>
                  <ion-col no-padding col-4><span advise-picture><img style="margin-top: 3px"
                        src="{{images.SURFACE}}"></span>Surface unknown
                  </ion-col>
                  <!-- <ion-col no-padding col-6><span advise-picture><img src="{{images.LIKE}}"></span>System OK</ion-col> -->
                  <ion-col no-padding col-6><span advise-picture><img src="{{images.INCREASE}}"></span>Increase
                    performance or thickness</ion-col>
                </ion-row>
              </ion-grid>
            </td>
          </tr>

          <tr>
            <td text-center text-center class="mesure">{{project.currency}}</td>
            <td text-center>{{!report_result ? 0 : report_result.bars.current.losses[1] | number: '1.0-0'}}</td>
            <td text-right>{{!report_result ? 0 : report_result.bars.basic.savings[1] | number: '1.0-0'}}</td>
            <td text-center class="p-0" style="padding: 0; white-space: nowrap;">-</td>
            <td text-left>{{!report_result ? 0 : report_result.bars.economical.savings[1] | number: '1.0-0'}}</td>
          </tr>

          <tr>
            <td text-center double-border class="mesure">tn CO<sub>2</sub></td>
            <td double-border text-center>{{totals.co2[0] | number: '1.2-2'}}</td>
            <td double-border text-right>{{totals.co2[0] - totals.co2[1] | number: '1.2-2'}}</td>
            <td double-border text-center class="p-0" style="padding: 0; white-space: nowrap;">-</td>
            <td double-border text-left>{{totals.co2[0] - totals.co2[2] | number: '1.2-2'}}</td>
          </tr>

        </tfoot>
      </table>
    </div>
    </ng-container>

    <ng-container *ngIf="!!reports.length && navParams.get('showComponent')">
      <ng-container *ngFor="let c of components">
        <ng-container *ngFor="let report of c.reports">
          <div text-center class="header-spacer page-break"></div>
          <output [attr.page-number]="getReportPageCounter(report)" class="component-first-page">
            This Report was produced using the TBI-App developed by EiiF: www.eiif.org
          </output>
          <ion-grid class="report-grid-pdf" style="margin-top: 0">
            <ion-row no-padding>
              <h4 col-12 style="margin:0">{{report.component.fields.location}}: {{report.summary_id}}</h4>
              <ion-col col-7>
                <ion-item col-5>
                  <label>Project</label>
                  <h4>{{report.component.project.name}}</h4>
                </ion-item>
                <ion-item col-5>
                  <label>Component Location</label>
                  <h4>{{report.component.fields.location}}</h4>
                </ion-item>
                <ion-item col-5 *ngIf="!report.energy">
                  <label>Summary id</label>
                  <h4>{{report.summary_id}}</h4>
                </ion-item>
                <ion-item col-5 *ngIf="report.is('surface|pipe|valve|flange')">
                  <label>Energy cost ({{report.component.project.currency}})</label>
                  <h4>{{report.component.project.price}}</h4>
                </ion-item>
                <ion-item col-5 *ngIf="report.is('surface|pipe|valve|flange')">
                  <label>CO<sub>2</sub> emission factor (grCO<sub>2</sub>/kWh)</label>
                  <h4>{{report.component.project.co2}}</h4>
                </ion-item>
                <ion-item col-5 *ngIf="report.is('pipe|valve|flange')">
                  <label>Diameter (mm)</label>
                  <h4>{{report.component.fields.nominal_diameter}}</h4>
                </ion-item>
                <ion-item col-5 *ngIf="report.is('pipe')">
                  <label>Length (m)</label>
                  <h4>{{report.component.fields.length}}</h4>
                </ion-item>
                <ion-item col-5 *ngIf="report.is('valve|flange')">
                  <label>Nº of items (m)</label>
                  <h4>{{report.component.fields.number}}</h4>
                </ion-item>
                <ion-item col-5 *ngIf="report.is('surface|pipe|valve|flange')">
                  <label>Operational time</label>
                  <h4>{{report.component.fields.operational_time}}</h4>
                </ion-item>
                <ion-item col-5 *ngIf="report.is('surface')">
                  <label>Surface (m<sup>2</sup>)</label>
                  <h4>{{report.component.fields.unknow_surface ? 'Unknow' : report.component.fields.surface}}</h4>
                </ion-item>
                <ion-item col-5 *ngIf="report.is('surface|pipe|valve|flange')">
                  <label>Surface material</label>
                  <h4>{{report.component.fields.friendly_surface_material}}</h4>
                </ion-item>
                <ion-item col-5 *ngIf="!report.component.fields.unknow_surface && report.energy">
                  <label>Surface temperature (&deg;C)</label>
                  <h4>{{report.component.fields.surface_temp}}</h4>
                </ion-item>
                <ion-item col-5 *ngIf="!!report.component.fields.unknow_surface">
                  <label>Medium temperature (&deg;C)</label>
                  <h4>{{report.component.fields.surface_temp}}
                    ({{report.component.fields.unknow_surface_temp == 1 ? 'Gas' : 'Liquid'}})</h4>
                </ion-item>
                <ion-item col-5 *ngIf="report.is('surface|pipe|valve|flange')">
                  <label>Ambient temperature (&deg;C)</label>
                  <h4>{{report.component.fields.ambient_temp}}</h4>
                </ion-item>
                <ion-item col-11 style="margin-left: 0" *ngIf="!!report.component.fields.damaged_cladding && !!report.component.fields.damaged_cladding.length && report.component.fields.damaged_cladding[0]">
                  <label>Damaged cladding</label>
                  <h4>{{report.component.fields.damaged_cladding_friendly}}</h4>
                </ion-item>
                <ion-item col-11 style="margin-left: 0" *ngIf="!!report.component.fields.damaged_insulation && !!report.component.fields.damaged_insulation.length && !!report.component.fields.damaged_insulation[0]">
                  <label>Damaged insulation</label>
                  <h4>{{report.component.fields.damaged_insulation_friendly}}</h4>
                </ion-item>
                <ion-item col-5 *ngIf="report.is('condensation')">
                  <label>Condensation</label>
                  <h4>
                    {{report.component.fields.condensation[0] ? 'Ice block': report.component.fields.condensation[1] ? 'Wet surface': 'None'}}
                  </h4>
                </ion-item>
                <ion-item col-11 style="margin-left: 0" *ngIf="!report.energy">
                  <label>Comments</label>
                  <h4>
                    {{report.comment || report.component.fields.damaged_comment || report.component.fields.condensation_comment}}
                  </h4>
                </ion-item>
                <ng-container>
                  <ion-col text-center col-12 d-inline-block *ngIf="report.first_picture" style="padding-top: 2.5rem">
                    <img style="height: 4.2in" src="{{report.first_picture.picture}}">
                  </ion-col>
                </ng-container>
              </ion-col>
              <ion-col col-5 no-padding text-left style="border-left: 1px solid rgb(48,84,150)">
                <div style="margin-left: -2rem" *ngIf="report.energy" class="report-result-container" report-result
                  col-12 [parent]="{report: report}"></div>
              </ion-col>
            </ion-row>
            <ion-row>
              <ng-container *ngFor="let picture of report.filtered_pictures(), let p = index">
                <output *ngIf="(p%4)==0" [attr.page-number]="getReportPicturePageCounter(report, p)"
                  class="component-picture-page page-break "></output>
                <div *ngIf="(p%4)==0" text-center class="header-spacer component-picture"></div>
                <ion-col padding col-6 text-center>
                  <img style="max-height: 4.2in" [style.margin-top]="(p%4)<2?'8rem':'0'" src="{{picture.picture}}">
                </ion-col>
              </ng-container>
            </ion-row>
          </ion-grid>
        </ng-container>
      </ng-container>

    </ng-container>

    <ion-grid class="last-page report-grid-pdf page-break" style="margin-top: 8rem">
      <output [attr.page-number]="getReportLastPage()" class="last-page page-break">
        This Report was produced using the TBI-App developed by EiiF: www.eiif.org
      </output>
      <ion-row *ngIf="!!project">
        <ion-col col-7 padding>
          <ng-container>
          <h4 style="margin: 1rem 0"><strong>Contacts</strong></h4>
          
          <ion-row *ngIf="!!project.people.leader.name" style="border-bottom: 1px solid #ccc; font-size: 1.2rem!important">
            <ion-col col-3>Project Leader:</ion-col>
            <ion-col col-3>{{project.people.leader.name}}</ion-col>
            <ion-col col-3><a href="mailto:{{project.people.leader.email}}">{{project.people.leader.email}}</a></ion-col>
            <ion-col col-3><a href="tel:{{project.people.leader.phone}}">{{project.people.leader.phone}}</a></ion-col>
          </ion-row>

          <ion-row *ngIf="!!project.people.energy_manager.name" style="border-bottom: 1px solid #ccc; font-size: 1.2rem!important">
            <ion-col col-3>Energy Manager:</ion-col>
            <ion-col col-3>{{project.people.energy_manager.name}}</ion-col>
            <ion-col col-3><a href="mailto:{{project.people.energy_manager.email}}">{{project.people.energy_manager.email}}</a></ion-col>
            <ion-col col-3><a href="tel:{{project.people.energy_manager.phone}}">{{project.people.energy_manager.phone}}</a></ion-col>
          </ion-row>

          <ion-row *ngIf="!!project.people.maintenance_manager.name" style="border-bottom: 1px solid #ccc; font-size: 1.2rem!important">
            <ion-col col-3>Maintenance Manager:</ion-col>
            <ion-col col-3>{{project.people.maintenance_manager.name}}</ion-col>
            <ion-col col-3><a href="mailto:{{project.people.maintenance_manager.email}}">{{project.people.maintenance_manager.email}}</a></ion-col>
            <ion-col col-3><a href="tel:{{project.people.maintenance_manager.phone}}">{{project.people.maintenance_manager.phone}}</a></ion-col>
          </ion-row>

          <ion-row *ngIf="!!project.people.hse_manager.name" style="border-bottom: 1px solid #ccc; font-size: 1.2rem!important">
            <ion-col col-3>HSE manager:</ion-col>
            <ion-col col-3>{{project.people.hse_manager.name}}</ion-col>
            <ion-col col-3><a href="mailto:{{project.people.hse_manager.email}}">{{project.people.hse_manager.email}}</a></ion-col>
            <ion-col col-3><a href="tel:{{project.people.hse_manager.phone}}">{{project.people.hse_manager.phone}}</a></ion-col>
          </ion-row>
        </ng-container>
          
          <ion-row>
            <fieldset class="fieldset">
              <legend>Insulation contact</legend>
              {{licences.getData().name}}<br>
              {{licences.getData().inspector_name}}<br>
              <ng-container *ngIf="!!licences.getData().engineer_id">Certified TIPCHECK engineer: {{licences.getData().engineer_id}}</ng-container>
              <a style="display: block"  href="tel:{{licences.getData().phone_number}}">{{licences.getData().phone_number}}</a>
              <a style="display: block" href="{{licences.getData().mail}}">{{licences.getData().mail}}</a>
              <a style="display: block"  href="{{licences.getData().url}}">{{licences.getData().url}}</a>
            </fieldset>
            
            <ion-col class="contact-float">
              <p><strong>You want to know more about TBI-Tools and EiiF?</strong></p>
              <p>Please contact to EiiF office: <a href="mailto:tbi@eiig.org">tbi@eiig.org</a> / <a href="htpp:/www.eiig.org">www.eiig.org</a> / <a href="tel:+41 22 99 500 70">+41 22 99 500 70</a></p>
            </ion-col>
          </ion-row>
        </ion-col>
        <ion-col col-5 style="border-left: 1px solid #014a97">
          <h4 col-12 style="margin: 1.3rem 1.6rem"><strong>About TBI</strong></h4>
          <ion-row>
            <ion-col col-12 style="text-align: justify; padding: 0 1in 0 2rem; font-size: 1.3rem">
              <p>
                TBI (TIPCHECK Based Inspections) is an easy-to-use insulation self-inspection
                and
                reporting tool for anyone who wants to very quickly check and estimate how much energy and
                money
                saving potential a technical insulation system has to offer.
              </p>
              <p>
                TBI offers a conservative estimation of the amount of energy a component is
                losing. In addition it shows the potential savings if insulated or if an
                improved
                insulation system is being installed. The saving estimations are given in a range evaluating the
                performance
                of
                a
                typical basic and a realistic good insulation system. The estimation methodology is based on:
              </p>
              <ol>
                <li>EiiF’s vast TIPCHECK experience: In 2010 the European Industrial Insulation Foundation developed its
                  insulation energy appraisal programme called Technical Insulation Performance Check.</li>
                <li>Simplified heat transfer formulas taken from the ISO 12241 Standard: Thermal insulation for building
                  equipment and industrial installations – calculation rules.</li>
                <li>Generic values allowing a conservative estimation like using by default e.g. 0 m/s wind speed and
                  horizontal
                  as the orientation of the system.</li>
              </ol>
            </ion-col>
          </ion-row>
        </ion-col>
      </ion-row>
    </ion-grid>

    <ng-template kendoPDFTemplate>
      <div class="page-template">
        <div class="header">
          <pdf-header></pdf-header>
        </div>
        <div class="footer">
          <ion-grid class="footer" style="border-top: 1px solid #ccc">
            <ion-row>
              <ion-col col-11 style="text-align: justify">
                <b>Disclaimer:</b> You should not rely solely on the TBI software application(s) for determining the
                performance of an
                insulation system and/or the energy or cost saving potential. The TBI software applications allow you
                to
                quickly check the performance of an insulation system and the energy or cost saving potential roughly,
                due to the influence of a number of factors, including data/input provided by the user. The software
                applications are not meant to replace professional advice. Under no circumstance EiiF and/or any EiiF
                member authorized to use the member version of the Software application will be liable for damages
                occurring to persons and properties of any nature and/or any other damages or losses arising out of
                the
                use of the TBI software application(s) or any information or service obtained through it, including
                direct,
                indirect, consequential or incidental damages and losses.
              </ion-col>
              <ion-col col-1 text-center>
                <img class="logo" src="{{images.TBI}}">
              </ion-col>
            </ion-row>
          </ion-grid>
        </div>
      </div>
    </ng-template>

  </kendo-pdf-export>
</ion-content>